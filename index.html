<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>learnmoreä¸‡åšã‚¯ã‚¤ã‚º</title>
<link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap" rel="stylesheet"> 
<style>
  body { font-family: 'Kosugi Maru', sans-serif; text-align: center; background: #f0f0f0; }
  #quizContainer, #nameInput { margin: 20px auto; width: 400px; background: #fff; padding: 20px; border-radius: 8px;ã€€}
  #certificate { margin: 20px auto; background: #fff; padding: 20px; border-radius: 8px; width: 820px; text-align: center;ã€€}
  button { margin: 5px; padding: 8px 12px; }
  img.quizImg { max-width: 400px; display: block; margin: 10px auto; }
  .iconOption { width: 80px; height: 80px; border: 2px solid #ccc; margin: 5px; cursor: pointer; }
  .selected { border-color: #007BFF; }
  .choiceBtn.selected { background-color: #007BFF; color: #fff; }
  .choiceBtn.disabled { opacity: 0.5; pointer-events: none; }
  #certificateCanvas { max-width: 400px; display: block; margin: 0 auto; }
</style>
</head>
<body>

<div id="quizContainer">
  <h2 id="questionNumber">å•é¡Œâ‘ </h2>
  <p id="questionText"></p>
  <img id="questionImg" class="quizImg" style="display:none;">
  <div id="choices"></div>
  <button id="confirmBtn" onclick="confirmAnswer()" disabled>å›ç­”</button>
  <div>
    <button id="prevBtn" onclick="prevQuestion()">â† å‰ã®å•é¡Œ</button>
    <button id="nextBtn" onclick="nextQuestion()">æ¬¡ã®å•é¡Œ â†’</button>
  </div>
  <p id="quizResult"></p>
</div>

<div id="nameInput" style="display:none;">
  <h2 id="nameInputTitle">è³çŠ¶ã‚’ä½œæˆã§ãã¾ã™</h2>
  <p>è³çŠ¶ã‚’ä½œæˆã§ãã¾ã™ï¼åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
  <input type="text" id="userNameField" placeholder="åå‰ã‚’å…¥åŠ›"><br><br>
  <p>ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠï¼š</p>
  <div id="iconSelection">
    <div>
      <img src="images/icon1.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon2.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon3.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon4.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon5.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon6.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon7.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon8.PNG" class="iconOption" onclick="selectIcon(this)">
      <img src="images/icon9.PNG" class="iconOption" onclick="selectIcon(this)">
    </div>
  </div><br>
  <button onclick="generateCertificate()">è³çŠ¶ã‚’è¡¨ç¤º</button>
</div>

<div id="certificate" style="display:none;">
  <canvas id="certificateCanvas" width="800" height="600"></canvas><br>
</div>

<script>
const quizzes = [
  { number: 1, question: "åœ°å›³ä¸Šã®ã€Œå•é¡Œâ‘ ã€ã®ä½ç½®ã«ã‚ã‚‹ãŠå¯¿å¸å±‹ã•ã‚“ã¯ä½•ã§ã—ã‚‡ã†ï¼Ÿ", choices: ["ãã‚‰å¯¿å¸","ã‚¹ã‚·ãƒ­ãƒ¼","å¤§èµ·æ°´ç”£"], answer: "ãã‚‰å¯¿å¸", img: null },
  { number: 2, question: "ã“ã®ç”»åƒã®å£é¢ã¯ã©ã®ãƒ‘ãƒ“ãƒªã‚ªãƒ³ã«ã‚ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ", choices: ["ã‚³ãƒ¢ãƒ³ã‚ºBé¤¨","ã‚³ãƒ¢ãƒ³ã‚ºCé¤¨","ã‚³ãƒ¢ãƒ³ã‚ºDé¤¨"], answer: "ã‚³ãƒ¢ãƒ³ã‚ºCé¤¨", img: "images/q2.png" },
  { number: 3, question: "ã€Œï¼’å„„å††ãƒˆã‚¤ãƒ¬ã€ã§æœ‰åãªãƒˆã‚¤ãƒ¬ï¼•ã§ä½¿ã‚ã‚Œã¦ã„ãªã„è‰²ã¯ä½•ã§ã—ã‚‡ã†ï¼Ÿ", choices: ["ã‚ªãƒ¬ãƒ³ã‚¸","é»„è‰²","ç·‘"], answer: "ç·‘", img: null },
  { number: 4, question: "ã“ã®ç”»åƒã®å£é¢ã¯ã©ã®ãƒ‘ãƒ“ãƒªã‚ªãƒ³ã«ã‚ã‚‹ã§ã—ã‚‡ã†ï¼Ÿ", choices: ["é–¢è¥¿ãƒ‘ãƒ“ãƒªã‚ªãƒ³","EXPO ãƒ›ãƒ¼ãƒ«ã€Œã‚·ãƒ£ã‚¤ãƒ³ãƒãƒƒãƒˆã€","ä¸‰è±æœªæ¥é¤¨"], answer: "EXPO ãƒ›ãƒ¼ãƒ«ã€Œã‚·ãƒ£ã‚¤ãƒ³ãƒãƒƒãƒˆã€", img: "images/q4.png" },
  { number: 5, question: "ä¸‡åšã®ä¸­å¤®ã«ã‚ã‚‹ã€è‡ªç„¶è±Šã‹ãªã‚¾ãƒ¼ãƒ³ã®åå‰ã¯ä½•ã§ã—ã‚‡ã†ï¼Ÿ", choices: ["é™ã‹ãªæ—","é™å¯‚ã®å…¬åœ’","é™ã‘ã•ã®æ£®"], answer: "é™ã‘ã•ã®æ£®", img: null },
];

let currentIndex = 0;
let answers = Array(quizzes.length).fill(null);
let selectedOption = null;
let selectedIcon = null;

// ã‚¯ã‚¤ã‚ºè¡¨ç¤º
function displayQuestion() {
  const q = quizzes[currentIndex];
  document.getElementById("questionNumber").innerText = `å•é¡Œ${q.number}`;
  document.getElementById("questionText").innerText = q.question;

  const imgEl = document.getElementById("questionImg");
  if(q.img){ imgEl.src = q.img; imgEl.style.display="block"; } else { imgEl.style.display="none"; }

  const choicesDiv = document.getElementById("choices");
  choicesDiv.innerHTML = "";
  selectedOption = answers[currentIndex] !== null ? answers[currentIndex] : null;

  q.choices.forEach(c => {
    const btn = document.createElement("button");
    btn.innerText = c;
    btn.className = "choiceBtn";
    if(answers[currentIndex] !== null){
      btn.classList.add("disabled");
      if(c === answers[currentIndex]) btn.classList.add("selected");
    }
    btn.onclick = () => { selectOption(btn, c); };
    choicesDiv.appendChild(btn);
  });

  const confirmBtn = document.getElementById("confirmBtn");
  confirmBtn.disabled = answers[currentIndex] !== null || selectedOption === null;

  // å·¦å³ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
  document.getElementById("prevBtn").style.display = currentIndex === 0 ? "none" : "inline-block";
  document.getElementById("nextBtn").style.display = currentIndex === quizzes.length-1 ? "none" : "inline-block";

  document.getElementById("quizResult").innerText = answers[currentIndex] !== null ? 
    (answers[currentIndex]===q.answer ? "æ­£è§£" : "ä¸æ­£è§£") : "";
}

// é¸æŠè‚¢é¸æŠ
function selectOption(btn, choice){
  if(answers[currentIndex] !== null) return;
  selectedOption = choice;
  document.querySelectorAll(".choiceBtn").forEach(b=>b.classList.remove("selected"));
  btn.classList.add("selected");
  document.getElementById("confirmBtn").disabled = false;
}

// æ±ºå®šãƒœã‚¿ãƒ³
function confirmAnswer(){
  if(selectedOption === null) return;
  answers[currentIndex] = selectedOption;
  document.querySelectorAll(".choiceBtn").forEach(b=>b.classList.add("disabled"));
  const q = quizzes[currentIndex];
  if(selectedOption === q.answer){
    document.getElementById("quizResult").innerText = "æ­£è§£ï¼ã‚„ã£ãŸã­ğŸ’®";
  } else {
    document.getElementById("quizResult").innerText = `æ®‹å¿µğŸ˜­ æ­£è§£ã¯ã€Œ${q.answer}ã€ã§ã™`;
  }

  // æœ€å¾Œã®å•é¡Œã‹ã‚‰1ç§’å¾…ã£ã¦åå‰å…¥åŠ›ç”»é¢
  if(currentIndex === quizzes.length-1){
    setTimeout(()=>{
      const correctCount = answers.filter((a,i)=>a===quizzes[i].answer).length;
      document.getElementById("nameInputTitle").innerText = `ã‚ãªãŸã¯${quizzes.length}å•ä¸­${correctCount}å•æ­£è§£ã—ã¾ã—ãŸ`;
      document.getElementById("quizContainer").style.display="none";
      document.getElementById("nameInput").style.display="block";
    }, 1000); // 1ç§’å¾Œ
  }
}

// å‰å¾Œãƒœã‚¿ãƒ³
function prevQuestion(){ if(currentIndex>0){ currentIndex--; displayQuestion(); } }
function nextQuestion(){ if(currentIndex<quizzes.length-1){ currentIndex++; displayQuestion(); } }

// ã‚¢ã‚¤ã‚³ãƒ³é¸æŠ
function selectIcon(imgEl){
  document.querySelectorAll(".iconOption").forEach(i=>i.classList.remove("selected"));
  imgEl.classList.add("selected");
  selectedIcon = imgEl.src;
}

// è³çŠ¶ç”Ÿæˆ
function generateCertificate(){
  const name = document.getElementById("userNameField").value.trim();
  if(!name){ alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"); return; }
  if(!selectedIcon){ alert("ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„"); return; }

  const correctAnswers = answers.filter((a,i)=>a===quizzes[i].answer).length;

  document.getElementById("nameInput").style.display="none";
  document.getElementById("certificate").style.display="block";

  const canvas = document.getElementById("certificateCanvas");
  const ctx = canvas.getContext("2d");

  const bg = new Image();
  bg.src = (correctAnswers === quizzes.length) ? "images/fullscore.png" : "images/participation.png";

  bg.onload = () => {
    ctx.drawImage(bg,0,0,canvas.width,canvas.height);

    const iconImg = new Image();
    iconImg.src = selectedIcon;
    iconImg.onload = ()=>{
      ctx.drawImage(iconImg, 325, 320, 150, 150);

      // åå‰è¡¨ç¤º
      ctx.font = "36px 'Kosugi Maru'";
      ctx.textAlign = "center";

      // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã§é‡‘è‰²é¢¨
      let gradientName = ctx.createLinearGradient(0, 0, 0, 100);
      gradientName.addColorStop(0, "#FFD700");
      gradientName.addColorStop(1, "#B8860B");
      ctx.fillStyle = gradientName;

      ctx.fillText(name, canvas.width/2, 275);

      // æ—¥ä»˜è¡¨ç¤º
      const today = new Date();
      const dateStr = today.getFullYear() + "å¹´" +
                     (today.getMonth()+1) + "æœˆ" +
                     today.getDate() + "æ—¥";
      ctx.font = "24px 'Kosugi Maru'";
      let gradientDate = ctx.createLinearGradient(0, 0, 0, 50);
      gradientDate.addColorStop(0, "#FFD700");
      gradientDate.addColorStop(1, "#B8860B");
      ctx.fillStyle = gradientDate;

      ctx.fillText(dateStr, canvas.width/2, canvas.height - 80);

      // Canvasã‚’ç”»åƒã«å¤‰æ›
      const imgData = canvas.toDataURL("image/png");

      // canvaséè¡¨ç¤º
      canvas.style.display = "none";

      // imgã‚¿ã‚°ã‚’ä½œæˆã—ã¦å·®ã—è¾¼ã‚€
      const resultImg = document.createElement("img");
      resultImg.src = imgData;
      resultImg.alt = "å®Œæˆã—ãŸè³çŠ¶";
      resultImg.style.maxWidth = "100%";

      // è¡¨ç¤ºå ´æ‰€ã«è¿½åŠ ï¼ˆcanvasã®ä¸‹ã«è¡¨ç¤ºï¼‰
      document.getElementById("certificate").appendChild(resultImg);
    };
  };
}

// åˆæœŸè¡¨ç¤º
displayQuestion();
</script>

</body>
</html>
















